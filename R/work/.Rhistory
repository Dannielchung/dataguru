M[i,i]
M[i]
M
M[1,2]
i
item <- unique(sort(data$iid))
item
uidx <- match(data$uid, user)
uidx
iidx <- match(data$iid, item)
iidex
iidx
i <- cbind(uidx, iidx, pref=data$pref)
i
data
M
i <- cbind(uidx, iidx)
i
i <- cbind(uidx, iidx, pref=data$pref)
i
M[i$uidx,i$iidx]
i$iidx
i
i$uidx
i[1,]
i[,1]
i[1,]
i[1,][1]
i[1,]$uidx
i[1,]
i[1,][2]
i[1,][3]
i[1,]pref
i[1,]$pref
i[1,]
M[i[1,][1],i[1,][2]]<-i[i,][3]
M
data
i[i,][3]
i
i[1,][3]
M[i[1,][1],i[1,][2]]<-i[1,][3]
M
length(i)
length(i[1,])
nrow(i)
for(n in 1:nrow(i)){
M[i[n,][1],i[n,][2]]<-i[n,][3]
}
M
user <- unique(data$uid)
item <- unique(sort(data$iid))
uidx <- match(data$uid, user)
iidx <- match(data$iid, item)
M <- matrix(0, length(user), length(item))
i <- cbind(uidx, iidx, pref=data$pref)
for(n in 1:nrow(i)){
M[i[n,][1],i[n,][2]]<-i[n,][3]
}
M
mod <- colSums(M^2)^0.5
MM <- M %*% diag(1/mod)
S <- crossprod(MM)
R <- M %*% S
R <- apply(R, 1, FUN=sort, decreasing=TRUE, index.return=TRUE)
k <- 5
res <- lapply(R, FUN=function(r)return(item[r$ix[1:k]]))
res
M
dist
d<-dist(M,method="euclidean")
d
NEIGHBORHOOD_NUM<-2
RECOMMENDER_NUM<-3
FILE<-"testCF.csv"
NEIGHBORHOOD_NUM<-2
RECOMMENDER_NUM<-3
data<-read.csv(FILE,header=FALSE)
names(data)<-c("uid","iid","pref")
data
user <- unique(data$uid)
item <- unique(sort(data$iid))
uidx <- match(data$uid, user)
iidx <- match(data$iid, item)
M <- matrix(0, length(user), length(item))
i <- cbind(uidx, iidx, pref=data$pref)
for(n in 1:nrow(i)){
M[i[n,][1],i[n,][2]]<-i[n,][3]
}
M
d<-dist(M,method="euclidean")
d
simi<-1/(1+d)
simi
d
simi<-1/(1+d)
simi
simi
dist
d<-dist(M,method="euclidean",diag=TRUE)
d
?dist
d<-dist(M,method="euclidean")
d
simi<-1/(1+d)
simi
simi
mode(simi)
simi[1]
simi[1][1]
simi[1][2]
simi[1][3]
simi[3][1]
simi
as.matrix(simi)
as.matrix(simi)[1][2]
as.matrix(simi)[1]
simi_mat<-as.matrix(simi)
simi_mat
simi_mat[1]
simi_mat[,1]
simi_mat[1,]
simi_mat[1,][2]
user
length(user)
nuser<-length(user)
nuser
simi_mat[,nuser][nuser]
for(i in 1:nuser){
print(simi_mat[,i][i])
}
print(simi_mat[,1][1])
simi_mat[,1][1]
simi_mat[,1]
simi_mat[,1][1]
simi_mat[,1][2]
neig<-list()
neig
neig<-list(5)
negi
neig
neig<-list()
neig
simi_mat[,1]
sort(simi_mat[,1])
sort(-simi_mat[,1])
sort
sort(-simi_mat[,1],decreasing =TRUE)
sort(simi_mat[,1],decreasing =TRUE)
sort(simi_mat[,1],decreasing =TRUE)[1]
sort(simi_mat[,1],decreasing =TRUE)[2]
sort(simi_mat[,1],decreasing =TRUE)[1:2]
neig<-list()
for(i in 1:nuser){
neig[i]<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
}
sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
neig[i]
neig<-list()
neig
neig[i]<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
mode(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
class(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM][1]
sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]$label
a<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
a
fix(a)
a$names
fix(a)
a$Names
a
fix(a)
a$.Names
a[.Names]
a$.Names
mode(a)
a[1]
a[1]$.Name
a[1]$.Names
a[1]$Names
a[1]
fix(a)
a[]
a[]$.Names
a$.Names
fix(a)
fix(d)
fix(iidx)
fix(a)
names(a)
names(a)[1]
names(a)[2]
names(a)
values(a)
attributes(a)
a
neig<-list()
neig
neig[1]<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
neig
neig[1]<-c(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
negi
neig
neig<-list()
neig[1]<-c(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
as.matrix(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
neig[1]<-as.matrix(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
neig
as.data.frame(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
as.data.frame(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
neig[1]<-as.data.frame(sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM])
neig
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
neighborhood
temp<-as.data.frame(neighborhood)
temp
name(temp)<-names(neighborhood)
names(neighborhood)
names(temp)<-names(neighborhood)
temp
neighborhood
temp
cbind(temp,names(neighborhood))
neig[1]<-cbind(names(as.data.frame(neighborhood)),temp)
neig<-list(c(),c())
neig
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
temp<-as.data.frame(neighborhood)
temp
cbind(names(neighborhood),temp)
neig[1]<-cbind(names(neighborhood),temp)
neig
neig<-data.frame()
neig
temp
neighborhood
temp
neighborhood
names(neighborhood)
names(neighborhood)[1]
neighborhood[1]
temp
temp
temp[1]
neighborhood
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
print(c(i,names(neighborhood)[x], neighborhood[x]))
}
}
neig<-data.frame()
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
neig<-rbind(neig,(c(i,names(neighborhood)[x], neighborhood[x])))
}
}
neig
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
print(c(i,names(neighborhood)[x], neighborhood[x])))
}
}
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
print(c(i,names(neighborhood)[x], neighborhood[x]))
}
}
s<-data.frame(x1=c(),x2=c(),x3=c())
s
View(S)
View(s)
View(s)
s<-data.frame(x1=NA,x2=NA,x3=NA)
s
s<-s[-1]
s
s<-s[,-1]
s
s<-data.frame(x1=NA,x2=NA,x3=NA)
s<-s[,-1]
s
s<-s[-1,]
s
s<-data.frame(x1=NA,x2=NA,x3=NA)
s<-s[-1,]
s
View(s)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
rbind(s,(c(i,names(neighborhood)[x], neighborhood[x])))
}
}
s
s<-data.frame(x1=NA,x2=NA,x3=NA)
s<-s[-1,]
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
rbind(s,(c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x])))
}
}
s
s<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
rbind(s,(c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x])))
}
}
s<-s[-1,]
s
s<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
rbind(s,(c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x])))
}
}
s
rbind(s,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
s<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
s<-rbind(s,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
}
}
s
s<-data.frame(x1=NA,x2=NA,x3=NA)
s<-s[-1,]
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
s<-rbind(s,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
}
}
s
s<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,1],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
s<-rbind(s,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
}
}
s<-s[-1,]
s
simi_mat
s<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,i],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
s<-rbind(s,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
}
}
s<-s[-1,]
s
topN<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,i],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
topN<-rbind(topN,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
}
}
topN<-topN[-1,]
topN
M
M[1,]
M[1,]!=0
which(M[1,]!=0)
which(M[1,]==0)
topN$x1
topN$x1==1
topN[which(topN$x1==1),]
a2<-which(M[2,]!=0)
a2
intersect(a2,a1)
a1<-which(M[1,]==0)
a1
a2
intersect(a2,a1)
a
a<-intersect(a2,a1)
a
topN<-topN[-1,]
topN
topN$x3
topN$x3topN<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,i],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
topN<-rbind(topN,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
}
}
topN<-topN[-1,]
topN<-data.frame(x1=NA,x2=NA,x3=NA)
for(i in 1:nuser){
neighborhood<-sort(simi_mat[,i],decreasing =TRUE)[1:NEIGHBORHOOD_NUM]
for(x in 1:NEIGHBORHOOD_NUM){
topN<-rbind(topN,c(x1=i,x2=names(neighborhood)[x], x3=neighborhood[x]))
}
}
topN<-topN[-1,]
topN
topN[which(topN$x1==1),]
o<-topN[which(topN$x1==1),]
o
o[1,]
o[1,]$x3
o[1,]$x3*a
a
o[1,]$x3
as.double(o[1,]$x3)*a
apply(as.double(o[1,]$x3)*a,2,sum)
apply(as.double(o[1,]$x3)*a,1,sum)
as.double(o[1,]$x3)*a
a
data
M
M[2,4]
apply(as.double(o[1,]$x3)*M[2,a],2,sum)
M[2,a]
as.double(o[1,]$x3)*M[2,a]
a1<-which(M[1,]==0)
a1
o<-topN[which(topN$x1==1),]
o
a4<-which(M[4,]!=0)
a4
aa<-intersect(a4,a1)
aa
result2<-as.double(o[1,]$x3)*M[2,a]
result2
as.double(o[1,]$x3)*M[2,aa]
aa
M[4,aa]
as.double(o[1,]$x3)*M[4,aa]
sum(as.double(o[1,]$x3)*M[4,aa])
data
M
simi_mat
topN
o
a1
a2
a
aa
result2
result4
result4<-as.double(o[1,]$x3)*M[4,aa]
result4
a1
a2
a4
result2
M[4,aa]
M[2,a]
aa
M[2,a]
M[4,aa]
as.double(o[1,]$x3)
0
o
result4<-as.double(o[2,]$x3)*M[4,aa]
resu;t4
result4
o[1,]$x3
result4
result4[1]
item4<-(result2[1]+result4[1])/(as.double(o[1,]$x3)+as.double(o[2,]$x3))
item4
result2[2]
result4[2]
M[4,aa]
item6<-(0+result4[2])/(as.double(o[2,]$x3))
item6
item4<-(result2[1]+result4[1])/(as.double(o[1,]$x3)+as.double(o[2,]$x3))
item4
a
item
iidx
user
iidx
itemiidx
item
item
iidex
iidx
level(iidx)
table(iidx)
colSums
?colSums
data
M
simi_mat
topN
simi_mat
simi_mat[1][2]
simi_mat[,1][2]
simi_mat[,1][,2]
simi_mat[,1][2]
simi_mat[,1][4]
topN
#推荐矩阵
R <- matrix(0, length(user), length(item))
R
