data.frame(x1=c(1:10),x2=c(1:10))
x<-data.frame(x1=c(1:10),x2=c(1:10))
length(x[1,])
length(x[,1])
x=1:10
x
x/2
x % 2
x % 2
x % 2
mod(x)
x /2
x  % 2
x  %% 2
x %% 2
?aggregate
aggregate(x,by=x%%2,sum)
aggregate(x,by=as.list(x%%2),sum)
aggregate(x,by=list(x%%2),sum)
x=1:5
aggregate(x,by=list(x%%2),sum)
x=1:10
aggregate(x,by=list(x%%2),sum)
aggregate(x,by=list(x%%2),cbind)
aggregate(x,by=list(x%%2),rbind)
aggregate(x,by=list(x%%2),cbind)
n<-4
a<-1
#原始矩阵
S<-matrix(c(0,1/3,1/3,1/3,0,0,1/2,1/2,0,0,0,1,0,1,0,0),nrow=n)
#1矩阵（4*4）
U<-matrix(rep(1,16),nrow=n)
G<-a*S+(1-a)*(1/n)*U
q1<-q2<-q3<-q4<-1;
G
setwd("D:/homework/hadoop")
G
install.packages("R:pagerank")
install.packages("pagerank")
install.packages("Pagerank")
install.packages("PageRank")
install.packages("page")
pagerank <- function(G,method='eigen',d=.85,niter=100){
# follows the notation of the matlab article on pagerank.
# at http://www.mathworks.com/company/newsletters/news_notes/clevescorner/oct02_cleve.html
# G is a connectivity matrix, with G[i,j]=1 if page i points to page j
# method is either "power" or "eigen"
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
#  print(A)
if (method=='power'){
x <- rep(1,n)
for (i in 1:niter) x <- A%*%x
} else {
x <- Re(eigen(A)$vector[,1])
}
x/sum(x)
}
G <- rbind(c(0,1,1),c(0,0,1),c(1,0,0))
pagerank(G)
pagerank(G,'eigen')
G
G
S
pagerank(S)
G<-matrix(
c(0, 1, 1, 1, 1, 0, 1,
1, 0, 0, 0, 0, 0, 0,
1, 1, 0, 0, 0, 0, 0,
0, 1, 1, 0, 1, 0, 0,
1, 0, 1, 1, 0, 1, 0,
1, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 1, 0, 0),nrow=7
)
G
pagerank(G)
G<-matrix(
c(0, 1, 1/2, 0, 1/4, 1/2 , 0;
1/5, 0, 1/2, 1/3, 0, 0, 0;
1/5, 0, 0, 1/3, 1/4, 0, 0;
1/5, 0, 0, 0, 1/4, 0, 0;
1/5, 0, 0, 1/3, 0, 1/2, 1;
0, 0, 0, 0, 1/4, 0, 0;
1/5, 0, 0, 0, 0, 0, 0;
),nrow=7);
G
G<-matrix(
c(0, 1, 1/2, 0, 1/4, 1/2 , 0,
1/5, 0, 1/2, 1/3, 0, 0, 0,
1/5, 0, 0, 1/3, 1/4, 0, 0,
1/5, 0, 0, 0, 1/4, 0, 0,
1/5, 0, 0, 1/3, 0, 1/2, 1,
0, 0, 0, 0, 1/4, 0, 0,
1/5, 0, 0, 0, 0, 0, 0),nrow=7
)
G
pagerank(G)
pagerank(G,'eigen')
pagerank(G,'eigen',1)
pagerank(S,'eigen',1)
pagerank(G,'eigen',1)
S
S<-matrix(
c(0, 1, 1, 1, 1, 0, 1,
1, 0, 0, 0, 0, 0, 0,
1, 1, 0, 0, 0, 0, 0,
0, 1, 1, 0, 1, 0, 0,
1, 0, 1, 1, 0, 1, 0,
1, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 1, 0, 0),nrow=7
)
pagerank(S,'eigen',1)
pagerank
S<-matrix(c(0,1/3,1/3,1/3,0,0,1/2,1/2,0,0,0,1,0,1,0,0),nrow=n)
S
S<-matrix(c(0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0),nrow=n);
S
S<-t(matrix(c(0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0),nrow=n));
S
S<-matrix(
c(0, 1, 1, 1, 1, 0, 1,
1, 0, 0, 0, 0, 0, 0,
1, 1, 0, 0, 0, 0, 0,
0, 1, 1, 0, 1, 0, 0,
1, 0, 1, 1, 0, 1, 0,
1, 0, 0, 0, 1, 0, 0,
0, 0, 0, 0, 1, 0, 0),nrow=7
)
S
S<-t(matrix(c(0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0),nrow=n));
S
S<-t(matrix(c(0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0),nrow=n));
S
pagerank(S)
pagerank(S,'eigen',1)
n<-4
a<-0.85
S<-t(matrix(c(0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0),nrow=n));
S
U<-matrix(rep(1,16),nrow=n)
U
G<-a*S+(1-a)*(1/n)*U
G
q1<-q2<-q3<-q4<-1;
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
pagerank(S)
(1-0.85)/4
q1<-q2<-q3<-q4<-1;
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-q2<-q3<-q4<-0;
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
q1<-(1-a)/n
q2<-a*G[2,][1]*q1+a*G[2,][4]*q4+(1-a)/n
q3<-a*G[3,][1]*q1+a*G[3,][4]*q2+(1-a)/n
q4<-a*G[4,][1]*q1+a*G[4,][4]*q2+a*G[4,][3]*q3+(1-a)/n
q1;q2;q3;q4
pagerank<-function(G,method='eigen',d=.85,niter=100){
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
print(A)
if (method=='power'){
x <- rep(1,n)
for (i in 1:niter) x <- A%*%x
} else {
x <- Re(eigen(A)$vector[,1])
}
x/sum(x)
}
G
S
pagerank(S)
G
S
G=S
G
cvec <- apply(G,2,sum)
cves
cvec
cvec[cvec==0] <- 1
cvec
gvec <- apply(G,1,sum)
gvec
delta <- (1-d)/n
d=0.85
delta <- (1-d)/n
delta
A <- matrix(delta,nrow(G),ncol(G))
A
n <- nrow(G)
n
A[1,]
A[1,] <- A[1,] + d*G[1,]/cvec
A
cvec
d*G[1,]/cvec
G[1,]
G
A[2,] <- A[2,] + d*G[2,]/cvec
A
G[2,]
G[2,]*d
G[2,]*d/cvec
A
A[2,] + d*G[2,]/cvec
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
A
eigen(A)$vector
eigen(A)$vector[,1]
Re(eigen(A)$vector[,1])
Re
?Re
X
x
x <- Re(eigen(A)$vector[,1])
x
sum(x)
x/sum(x)
pagerank<-function(G,method='eigen',d=.85,niter=100){
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
#    print(A)
if (method=='power'){
x <- rep(1,n)
for (i in 1:niter) x <- A%*%x
} else {
x <- Re(eigen(A)$vector[,1])
}
x/sum(x)
}
eigen(A)$vector
A
eigen(A)
eigen(A)$vector
eigen(A)$vector[,1]
Re(eigen(A)$vector[,1])
Re(eigen(A)$vector[,1])/sum(Re(eigen(A)$vector[,1]))
pagerank(S)
(eigen(A)$vector[,1])/sum((eigen(A)$vector[,1]))
pagerank(S)
S
pagerank(S,"eigen",1)
pagerank<-function(G,method='eigen',d=.85,niter=100){
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
print(A)
if (method=='power'){
x <- rep(1,n)
for (i in 1:niter) x <- A%*%x
} else {
x <- Re(eigen(A)$vector[,1])
}
x/sum(x)
}
pagerank(S)
eigen(S)
A
S
eigen(S)
eigen(S)$vector
eigen(S)$vector[,1]
Re(eigen(S)$vector[,1])
x<-Re(eigen(S)$vector[,1])
x/sum(x)
S<-t(matrix(c(0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0),nrow=n));
S
pagerank(S,"eigen",1)
pagerank(S,"eigen",1)
pagerank<-function(G,method='eigen',d=.85,niter=100){
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
# print(A)
if (method=='power'){
x <- rep(1,n)
for (i in 1:niter) x <- A%*%x
} else {
x <- Re(eigen(A)$vector[,1])
}
x/sum(x)
}
pagerank(S,"eigen",1)
pagerank(S,"eigen",0.85)
n <- 10
G <- matrix(0,n,n)
G[1,2:n] <- 1
G[2:n,1] <- 1
pagerank(G)
n <- 10
G <- matrix(0,n,n)
G[1,2:3] <- G[2:3,1] <- 1
for (i in 1:(2*n)) {
i <- sample(1:n,1)
j <- sample(1:n,1)
G[i,j] <- 1
}
G
par(mfrow=c(3,2))
image(G);barplot(pagerank(G),ylim=c(0,1))
G2 <- G
n2 <- 20
G2 <- cbind(G,matrix(0,n,n2))
G2 <- rbind(G2,matrix(0,n2,n+n2))
G2[n+(1:n2),1] <- G2[1,n+(1:n2)] <- 1
image(G2);barplot(pagerank(G2),ylim=c(0,1))
for (i in 1:(2*n2)) {
i <- sample(1:n2,1)
j <- sample(1:n2,1)
G2[i+n,j+n] <- 1
}
image(G2);barplot(pagerank(G2),ylim=c(0,1))
S<-matrix(c(0,1,1,0,0,1,1,0,0),nrow=3)
S
pagerank(S,"eigen",0.85)
g1<-c(0,0,0,0,1/3,0,0,1,1/3,1/2,0,0,1/3,1/2,1,0)
g<-matrix(g1,4,4)
g<-t(g)
q<-c(0.25,0.25,0.25,0.25)
for (i in 1:100){
q<-g%*%q
print(i)
print(q)
}
g1<-c(0,0,0,0,1/3,0,0,1,1/3,1/2,0,0,1/3,1/2,1,0)
g<-matrix(g1,4,4)
g<-t(g)
q<-c(1,1,1,1)
for (i in 1:100){
q<-g%*%q
print(i)
print(q)
}
g1<-c(0,0,0,0,1/3,0,0,1,1/3,1/2,0,0,1/3,1/2,1,0)
g<-matrix(g1,4,4)
g<-t(g)
q<-c(0.25,0.25,0.25,0.25)
for (i in 1:100){
q<-g%*%q
print(i)
print(q)
}
g1<-c(0,0,0,0,1/3,0,0,1,1/3,1/2,0,0,1/3,1/2,1,0)
g<-matrix(g1,4,4)
g<-t(g)
q<-c(1,1,1,1)
for (i in 1:1000){
q<-g%*%q
print(i)
print(q)
}
S<-matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),nrow=4)
S
S<-matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),row=TRUE,nrow=4)
S<-matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),byrow=TRUE,nrow=4)
S
pagerank(S,"eigen",0.85)
S
S<-t(matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),byrow=TRUE,nrow=4))
pagerank(S,"eigen",0.85)
S
S<-(matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),byrow=TRUE,nrow=4)
)
S
S<-t(matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),byrow=TRUE,nrow=4)
)
S
pagerank<-function(G,method='eigen',d=.85,niter=100){
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
print(A)
if (method=='power'){
x <- rep(1,n)
for (i in 1:niter) x <- A%*%x
} else {
x <- Re(eigen(A)$vector[,1])
}
x/sum(x)
}
S<-matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),byrow=TRUE,nrow=4)
S
pagerank(S,"eigen",0.85)
pagerank(S,"eigen",1)
pagerank(S)
pagerank(t(S))
S<-t(matrix(c(0,0,0,0,1,0,0,1,1,1,0,0,1,1,1,0),nrow=n));
S<-matrix(c(0,1,1,0,0,1,1,0,0),nrow=3)
S
S<-matrix(c(0,1,1,0,0,0,1,1,0,0,0,1,0,0,0,0),byrow=TRUE,nrow=4)
S
pagerank(t(S),"eigen",0.85)
pagerank<-function(G,method='eigen',d=.85,niter=100){
cvec <- apply(G,2,sum)
cvec[cvec==0] <- 1 # nodes with indegree 0 will cause problems if we divide by 0.
gvec <- apply(G,1,sum)
n <- nrow(G)
delta <- (1-d)/n
A <- matrix(delta,nrow(G),ncol(G))
for (i in 1:n)
A[i,] <- A[i,] + d*G[i,]/cvec
#   print(A)
if (method=='power'){
x <- rep(1,n)
for (i in 1:niter) x <- A%*%x
} else {
x <- Re(eigen(A)$vector[,1])
}
x/sum(x)
}
pagerank(t(S),"eigen",0.85)
